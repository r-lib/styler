<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Alignment detection • styler</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Alignment detection">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">styler</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.10.3.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/styler.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/detect-alignment.html">Alignment detection</a></li>
    <li><a class="dropdown-item" href="../articles/strict.html">The effect of `strict = FALSE`</a></li>
    <li><a class="dropdown-item" href="../articles/third-party-integrations.html">Third-party integrations</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Developers</h6></li>
    <li><a class="dropdown-item" href="../articles/remove_rules.html">Remove rules</a></li>
    <li><a class="dropdown-item" href="../articles/customizing_styler.html">Customizing styler</a></li>
    <li><a class="dropdown-item" href="../articles/distribute_custom_style_guides.html">Distribute custom style guides</a></li>
    <li><a class="dropdown-item" href="../articles/caching.html">Caching</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2017/12/styler-1.0.0/">Version 1.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2019/11/styler-1-2-0/">Version 1.2.0</a></li>
    <li><a class="external-link dropdown-item" href="https://lorenzwalthert.netlify.com/post/styler-1-3-0/">Version 1.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://lorenzwalthert.netlify.app/post/styler-1-4-0/">Version 1.4.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/styler/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Alignment detection</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/r-lib/styler/blob/main/vignettes/detect-alignment.Rmd" class="external-link"><code>vignettes/detect-alignment.Rmd</code></a></small>
      <div class="d-none name"><code>detect-alignment.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Sometimes, you deliberately align code to make it more readable.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/call.html" class="external-link">call</a></span><span class="op">(</span></span>
<span>  a   <span class="op">=</span>       <span class="fl">3</span>,</span>
<span>  bre <span class="op">=</span> <span class="fl">3213232</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Until styler 1.1.1.9002 (with <code>strict = TRUE</code>, e.g. as in
<code>styler::style_file(..., strict = TRUE)</code>), this was formatted
as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/call.html" class="external-link">call</a></span><span class="op">(</span></span>
<span>  a <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  bre <span class="op">=</span> <span class="fl">3213232</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>because no alignment detection was built in.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;With &lt;code&gt;strict = FALSE&lt;/code&gt;, the spacing would have
been kept, however, &lt;code&gt;strict = FALSE&lt;/code&gt; has a number of other
implications because it is in general less invasive. For example, it
would not add braces and line breaks to “if (TRUE) return()”.&lt;/p&gt;"><sup>1</sup></a></p>
<p>styler &gt;= 1.1.1.9003 detects aforementioned alignment for function
calls. This vignette describes how aligned code is defined in styler and
gives some examples so users can format their aligned code to match the
definition styler uses to ensure their code is not unintentionally
reformatted.</p>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<p>These typical examples match <em>styler</em>’s definition of
alignment. Note the spacing around operators and commas.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">key_here</span>,  <span class="op">~</span><span class="va">right_aligned</span>,</span>
<span>  <span class="st">"left"</span>,            <span class="st">"right"</span>, <span class="co"># comments are allowed</span></span>
<span>  <span class="st">"long string"</span>,      <span class="st">"shrt"</span> <span class="co"># columns can overlap ('~' above ',')</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">key_here</span>,     <span class="op">~</span><span class="va">left_aligned</span>,</span>
<span>  <span class="st">"left"</span>,        <span class="st">"right"</span>, <span class="co"># comments are allowed</span></span>
<span>  <span class="st">"long string"</span>, <span class="st">"shrt"</span> <span class="co"># columns can overlap ('~' above ',')</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># right-aligned after =</span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">fun</span>, <span class="co"># arguments on same line as opening brace are not considered</span></span>
<span>  arg2 <span class="op">=</span>       <span class="fl">2</span>,</span>
<span>  ar   <span class="op">=</span> <span class="fu">f</span><span class="op">(</span><span class="va">k</span>, <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># left aligned after =</span></span>
<span><span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">fun</span>, <span class="co"># arguments on same line as opening brace are not considered</span></span>
<span>  arg2 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  ar   <span class="op">=</span> <span class="fu">f</span><span class="op">(</span><span class="va">k</span>, <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a>
</h2>
<p>An important definition used in the remainder is the one of a
<strong>column</strong>. All arguments of a function call that have the
same position but are placed on different lines form a column. The below
call shows a call with two columns and two rows. Columns separate
arguments of the function call, so the separator is the comma. The first
row is named because all arguments are named, the second is unnamed:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/call.html" class="external-link">call</a></span><span class="op">(</span></span>
<span>  <span class="co"># column 1  | column 2 |</span></span>
<span>  abkj <span class="op">=</span> <span class="fu">f</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">7</span>,        <span class="co"># | row 1</span></span>
<span>  more_ <span class="op">=</span> <span class="st">"a"</span>, <span class="fl">2</span>         <span class="co"># | row 2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>For alignment detection, the first column is omitted if not
all arguments in that column are named</strong></p>
<div class="section level3">
<h3 id="function-calls">Function calls<a class="anchor" aria-label="anchor" href="#function-calls"></a>
</h3>
<p>Below, we try to explain in an intuitive way how your code should
look like to be recognized as aligned.</p>
<p>Make commas match position vertically and align everything right
before commas:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># all arguments of first column named -&gt; must right align values after `=`,</span></span>
<span><span class="co"># one or more spaces around `=`, none before and at least one after the comma.</span></span>
<span><span class="co"># aligned if the (imaginary) comma on the last line is in line with the commas</span></span>
<span><span class="fu">fell</span><span class="op">(</span></span>
<span>  x  <span class="op">=</span>    <span class="fl">1</span>,</span>
<span>  y  <span class="op">=</span>   <span class="fl">23</span>,</span>
<span>  zz <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># this works also with more than one column</span></span>
<span><span class="fu">fell</span><span class="op">(</span></span>
<span>  x  <span class="op">=</span>    <span class="fl">1</span>, annoying <span class="op">=</span>       <span class="fl">3</span>,</span>
<span>  y  <span class="op">=</span>   <span class="fl">23</span>, <span class="co"># nothing in column 2 for row 2</span></span>
<span>  zz <span class="op">=</span> <span class="cn">NULL</span>, finally  <span class="op">=</span> <span class="st">"stuff"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># or if not all arguments of the first column are named</span></span>
<span><span class="fu">gell</span><span class="op">(</span></span>
<span>  p <span class="op">=</span> <span class="fl">2</span>,   g <span class="op">=</span> <span class="fu">gg</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,  n <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="fl">3</span>, <span class="co">#</span></span>
<span>  <span class="fl">31</span>,    fds <span class="op">=</span>    <span class="op">-</span><span class="fl">1</span>, gz <span class="op">=</span> <span class="va">f</span> <span class="op">/</span> <span class="fl">3</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
<p>… or match position of <code>=</code> vertically and align everything
after this operator left</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># all arguments of first column named -&gt; must left align values after `=`,</span></span>
<span><span class="co"># at least one space before `=`, exactly one after, none before and at least one</span></span>
<span><span class="co"># after the comma.</span></span>
<span><span class="co"># aligned if the first values after `=` are aligned (and exactly one space after</span></span>
<span><span class="co"># `=`)</span></span>
<span><span class="fu">fell</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  y <span class="op">=</span> <span class="fl">23</span>,</span>
<span>  zz <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># this works also with more than one column</span></span>
<span><span class="fu">fell</span><span class="op">(</span></span>
<span>  x  <span class="op">=</span> <span class="fl">1</span>,   annoying <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  y  <span class="op">=</span> <span class="fl">23</span>, <span class="co"># nothing in column 2 for row 2</span></span>
<span>  zz <span class="op">=</span> <span class="cn">NULL</span>, finally <span class="op">=</span> <span class="st">"stuff"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># or if not all arguments of the first column are named</span></span>
<span><span class="fu">gell</span><span class="op">(</span></span>
<span>  p <span class="op">=</span> <span class="fl">2</span>, g <span class="op">=</span> <span class="fu">gg</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="fl">3</span>, <span class="co">#</span></span>
<span>  <span class="fl">31</span>, fds <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, gz <span class="op">=</span> <span class="va">f</span> <span class="op">/</span> <span class="fl">3</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
<p>… or match the start of the token after <code>,</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/call.html" class="external-link">call</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">2</span>,           p <span class="op">=</span> <span class="st">"another"</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"hhjkjkbew"</span>, x <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">x</span>,        <span class="op">~</span><span class="va">y</span>,</span>
<span>  <span class="st">"another"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>  <span class="st">"b"</span>,       <span class="fl">1211234</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comments">Comments<a class="anchor" aria-label="anchor" href="#comments"></a>
</h3>
<p>not supported yet.</p>
</div>
<div class="section level3">
<h3 id="assignment">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h3>
<p>not supported yet.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://krlmlr.info" class="external-link">Kirill Müller</a>, <a href="https://lorenzwalthert.com" class="external-link">Lorenz Walthert</a>, <a href="https://sites.google.com/site/indrajeetspatilmorality/" class="external-link">Indrajeet Patil</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
